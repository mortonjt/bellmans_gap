#ifndef LOOKUP_HH
#define LOOKUP_HH


enum Rules { S_S_O, S_S_P, S_O, S_P, T_T_O, T_T_P, T_O, T_P, R_T_O, R_T_P, O_A, O_C, O_G, O_U, O_N, P_A_R_A, P_A_R_C, P_A_R_G, P_A_R_U, P_A_R_N, P_C_R_A, P_C_R_C, P_C_R_G, P_C_R_U, P_C_R_N, P_G_R_A, P_G_R_C, P_G_R_G, P_G_R_U, P_G_R_N, P_U_R_A, P_U_R_C, P_U_R_G, P_U_R_U, P_U_R_N, P_N_R_A, P_N_R_C, P_N_R_G, P_N_R_U, P_N_R_N, P_A_P_A, P_A_P_C, P_A_P_G, P_A_P_U, P_A_P_N, P_C_P_A, P_C_P_C, P_C_P_G, P_C_P_U, P_C_P_N, P_G_P_A, P_G_P_C, P_G_P_G, P_G_P_U, P_G_P_N, P_U_P_A, P_U_P_C, P_U_P_G, P_U_P_U, P_U_P_N, P_N_P_A, P_N_P_C, P_N_P_G, P_N_P_U, P_N_P_N }; 

const double rule_prob[65][20] = {
{ -0.283257, -0.00484262, -0.12537, -0.0150379, -0.0160431, -0.0168543, -0.0829969, -0.0692918, -0.0277499, -0.0367014, -0.120628, -0.310155, -0.209721, -0.538997, -0.164303, -0.153056, -0.115266, -0.0872646, -0.115658, -0.102836 }, // S_S_O
{ -6.88449, -6.43133, -2.16519, -4.54116, -4.54595, -4.49703, -2.64795, -2.74643, -3.65101, -3.38039, -2.68558, -1.60944, -2.00148, -1.38629, -1.94591, -1.97119, -2.25533, -2.55112, -2.22309, -2.37106 }, // S_S_P
{ -1.40802, -6.43133, -6.46925,  -6.1506, -5.93225, -5.88332, -5.42053, -6.57508, -7.26193, -6.90675, -3.78419,  -3.4012, -3.61092, -2.48491, -5.44242, -6.63463, -6.20658, -5.88332, -7.65681, -9.17678 }, // S_O
{ -6.88449, -6.43133, -6.46925,  -6.1506, -5.93225, -5.88332, -5.42053, -6.57508, -7.26193, -6.90675, -3.78419,  -3.4012, -3.61092, -2.48491, -5.44242, -6.63463, -6.20658, -5.88332, -7.65681, -5.46321 }, // S_P
{ -0.359728, -0.0263672, -0.253657, -0.200584, -0.230187, -0.185782, -0.217591, -0.227725, -0.166793, -0.198858, -0.177552, -0.250485, -0.327763, -0.224351, -0.176499, -0.148263, -0.161852, -0.220842, -0.321355, -0.186565 }, // T_T_O
{ -11.5242, -4.37423, -1.69168, -1.86568, -1.64274, -1.94047, -1.84378, -1.69496, -1.97571, -1.82351,  -1.8933, -1.64101, -1.34975, -1.71323,  -1.9968, -2.03078, -1.95126, -1.66633, -1.31598, -1.78308 }, // T_T_P
{ -1.19711, -9.93105, -9.94932,  -9.6418,  -9.2766, -9.21771, -8.78109, -9.83644, -9.78566, -9.34049, -8.77059, -8.28349, -8.07838, -8.66596, -9.18973, -8.58186, -7.31255, -6.07304, -5.71043, -7.78697 }, // T_O
{ -9.73244, -4.31428, -3.22429, -3.61593, -4.41678, -3.65703, -3.29216, -3.91218, -4.20593, -3.97452, -4.42679, -3.59215,  -3.9195, -3.88683,  -3.6524,  -5.0555, -5.00997, -4.97443, -5.71043, -6.40067 }, // T_P
{ -0.000159426, -0.0178664, -0.15825, -0.196627, -0.211087, -0.113425, -0.103292, -0.109011, -0.12354, -0.288789, -0.21562, -0.225956, -0.269414, -0.227083, -0.178918, -0.259708, -0.311436, -0.540568, -0.585517, -0.0791373 }, // R_T_O
{ -8.74401, -4.03375, -1.92166, -1.72315, -1.65917, -2.23279, -2.32139, -2.27031, -2.15232, -1.38298, -1.64011, -1.59826, -1.44319, -1.59383, -1.80895, -1.47524, -1.31824, -0.873273, -0.813775, -2.57588 }, // R_T_P
{ -0.957927, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944 }, // O_A
{ -1.87325, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944 }, // O_C
{ -1.54746, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944 }, // O_G
{ -1.43362, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944 }, // O_U
{ -4.46927, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944, -1.60944 }, // O_N
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_A_R_A
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_A_R_C
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_A_R_G
{ -2.36006, -2.79461, -3.98602, -3.92206, -3.34433, -3.68831, -3.52414, -3.43658, -3.45452, -3.43858, -3.30919, -3.07604, -3.27309,  -2.9397,  -3.3879, -3.07995, -3.61877, -4.10058, -4.21705, -3.81348 }, // P_A_R_U
{ -6.62274,  -9.9601, -9.71287,  -8.2015, -8.41638, -8.85309, -8.74989,  -7.9562, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_A_R_N
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_C_R_A
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_C_R_C
{ -1.47524, -1.86603, -3.22976,   -3.061, -2.81981, -2.94501, -2.74354, -2.58184, -2.63948, -2.88306, -3.04807, -2.58788,  -2.4822, -2.64245,  -2.6978,  -3.4179, -3.66133,  -2.5965, -2.31993, -3.54521 }, // P_C_R_G
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_C_R_U
{ -6.62274, -8.86149,  -10.406, -9.11779, -8.41638, -7.24366, -7.65128, -7.00069, -9.14825, -8.09255, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -4.99213 }, // P_C_R_N
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_G_R_A
{ -1.67398, -2.23037, -3.59257, -2.90618, -2.89492, -2.66483, -3.40278, -3.11991, -2.80613,  -2.6698,  -2.7404, -2.64785, -2.76585, -2.65684, -2.53973, -2.94918, -3.61877, -3.47197, -4.62252, -4.43252 }, // P_G_R_C
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_G_R_G
{ -2.51186, -4.22031, -5.36907, -4.28947, -4.70281, -6.01988, -5.80545, -5.20893, -5.43468, -4.89387, -4.91059, -6.73102,  -6.6053, -5.68698, -6.87833, -5.79538, -2.99016, -2.65366, -3.36976, -5.27981 }, // P_G_R_U
{ -5.92959, -9.26696,  -10.406, -8.42464, -7.50009, -6.65587, -6.80398, -8.87249,  -8.4551, -8.78569, -7.03086, -6.73102, -7.99159, -7.29641, -7.79462, -7.99261, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_G_R_N
{ -1.92226, -2.70169, -3.64329, -3.47411, -3.40908,  -3.1133, -3.40278, -3.49721, -2.94168, -2.93062, -3.37588, -3.03384,  -3.3472,  -2.8656, -3.40017, -3.13279, -3.70578,  -5.0814, -2.71298, -2.66485 }, // P_U_R_A
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_U_R_C
{ -1.61879, -2.99219,  -4.2385, -3.63507, -3.87308, -4.15261, -4.40609, -4.42397, -4.47542, -4.12225, -5.08495, -5.75019, -5.28354, -6.04365, -5.54333, -4.73451, -5.69821, -5.48687, -6.00881, -4.58667 }, // P_U_R_G
{ -6.62274,  -9.9601,  -10.406, -9.81093, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_U_R_U
{ -6.62274, -8.57381, -9.30741, -8.42464, -9.10953, -7.06133, -8.74989, -8.17934,  -8.4551,  -7.3994, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_U_R_N
{ -6.62274,  -9.9601, -9.71287, -8.71232, -9.10953, -8.85309, -8.74989, -9.56563,  -8.4551, -7.68708, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -5.28456, -4.85091, -6.18002, -6.00881, -5.68528 }, // P_N_R_A
{ -6.62274,  -9.9601, -8.79658, -8.42464, -9.10953, -8.85309, -8.74989, -9.56563, -9.14825, -8.09255, -8.12947, -7.82963, -7.29845, -6.89095, -6.87833, -7.29946, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_N_R_C
{ -5.52412, -7.56221,  -10.406, -9.11779, -8.41638, -8.15995, -8.74989, -9.56563, -9.14825, -8.78569, -8.12947, -7.82963, -7.29845, -6.38012, -6.08987, -6.38317, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_N_R_G
{ -6.62274, -8.86149,  -10.406, -9.11779, -9.10953, -8.85309, -8.05674, -8.87249, -9.14825, -7.68708, -8.12947, -7.82963, -7.99159, -6.89095, -8.48776, -6.60631, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_N_R_U
{ -5.92959, -4.91668, -8.79658, -8.01917, -8.01091,  -7.4668, -7.14045, -8.46702, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_N_R_N
{ -6.62274, -6.17591, -6.45478, -5.91911, -5.89065,  -6.4552, -5.57184, -5.27517, -6.37566, -6.99393, -6.52003, -6.44334, -7.29845, -7.98956, -7.38915, -7.99261, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_A_P_A
{ -6.62274, -5.78572, -5.89516, -6.09736, -6.40147,  -4.6046, -5.53102, -5.85206, -6.25788, -6.30079, -5.73157, -6.22019,  -6.6053, -6.60327, -6.29054, -6.60631, -6.79682, -5.48687, -5.31567, -6.37843 }, // P_A_P_C
{ -6.62274, -6.82461, -7.07381, -6.92056, -5.08417,  -7.4668, -7.14045, -5.59534, -7.35649, -5.17477, -7.03086, -4.11606, -4.69576, -5.68698, -5.15556, -7.29946, -6.10368, -5.48687, -4.62252, -6.37843 }, // P_A_P_G
{ -6.62274,  -2.4808, -1.97831, -2.06723, -2.10919, -1.99874, -1.73059, -1.83064, -2.01976, -1.86898, -1.89506,  -2.1192, -2.31142, -2.19655, -2.04204, -1.90811, -1.79288, -1.50719, -1.84993, -1.68708 }, // P_A_P_U
{ -6.62274, -8.01419, -7.57281, -6.44364, -9.10953,  -6.4552, -7.65128, -5.71549, -7.53881, -7.68708, -7.43632, -7.82963, -7.99159, -7.29641, -7.79462, -7.99261, -6.79682, -6.18002, -6.00881, -3.89352 }, // P_A_P_N
{ -6.62274, -6.70201, -6.03657, -5.98229, -6.11379, -6.55051, -6.26498, -7.00069, -5.71426, -5.25933, -7.03086, -5.75019, -4.90055, -5.21697, -6.29054, -4.94808, -3.96361,  -5.0814,  -4.9102, -6.37843 }, // P_C_P_A
{ -6.62274, -8.57381, -7.22797, -7.03834,  -6.9123, -6.90718, -7.14045, -7.61972, -9.14825, -7.17625, -6.74318, -4.99642, -6.38215, -5.91012, -6.54185, -6.89399, -6.10368,  -5.0814, -6.00881, -6.37843 }, // P_C_P_C
{ -6.62274,  -2.0793, -1.69507, -1.52366,   -1.849,  -1.6977, -1.86848, -1.87626, -1.66839, -1.77538, -1.55439, -1.82822, -1.81158, -1.34058,   -1.732,  -1.6611, -1.68484, -1.71411,   -1.509, -2.06094 }, // P_C_P_G
{ -6.62274, -7.56221, -5.66109, -7.03834, -6.40147, -6.90718, -6.80398, -6.92658, -5.68252, -6.30079, -5.64456, -5.43174, -7.29845, -7.29641,   -6.696, -5.59471, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_C_P_U
{ -6.62274, -9.26696, -6.43573, -7.86502, -7.72323, -8.85309, -7.14045, -7.00069, -8.04964, -7.68708, -7.03086, -7.82963, -7.99159, -6.38012, -8.48776, -7.29946, -6.10368, -6.18002, -6.00881, -4.76899 }, // P_C_P_N
{ -6.62274, -7.39515, -4.89663,  -6.8152, -7.72323, -6.90718,  -7.3636,  -6.6212, -7.20234, -8.09255, -6.52003, -6.73102, -7.99159, -7.98956,   -6.696, -7.29946, -6.79682, -6.18002, -6.00881, -6.37843 }, // P_G_P_A
{ -6.62274, -1.84668, -1.38117, -1.73597, -1.48149, -1.51616, -1.50424,  -1.7372, -1.61136, -1.58901, -1.46889, -1.52153, -1.47244, -1.73959, -1.59716, -1.68633, -1.59282, -1.66916, -1.88168, -2.10176 }, // P_G_P_C
{ -6.62274, -5.40623, -6.94028, -6.67544, -6.01848, -7.75448,  -7.3636, -6.38758, -7.20234,  -7.3994, -7.43632, -7.82963, -6.19983, -7.29641, -5.35227, -5.22002, -5.41053, -4.38826, -4.62252, -6.37843 }, // P_G_P_G
{ -6.62274, -3.41332, -2.77556, -2.92236, -3.21512, -3.12951, -2.72887, -2.54366,  -3.1518,  -2.9164, -3.15274, -3.55296, -2.85579, -3.28003, -2.54234, -2.74033, -2.82653, -3.28964, -4.39938, -4.76899 }, // P_G_P_U
{ -6.62274, -8.16834, -6.87966, -7.61371, -6.40147, -7.24366, -5.49179, -6.19834, -7.76196, -6.83978, -7.43632, -7.82963, -7.99159, -7.29641, -7.38915, -7.29946, -6.79682, -6.18002, -6.00881, -3.98053 }, // P_G_P_N
{ -6.62274,  -2.4933, -1.98666, -1.85516, -1.88696, -1.91772, -2.11394,  -1.9829, -2.03348, -2.06547, -2.11575, -2.05819, -2.01018, -2.28912, -2.13513, -2.26576, -2.36601, -3.23558, -2.45347, -1.95959 }, // P_U_P_A
{ -6.62274, -7.76288, -6.14334, -6.63288, -6.40147, -6.36819, -6.80398,  -6.5699, -6.75036, -6.99393, -7.03086, -6.03787, -6.04568, -6.60327, -7.79462, -7.99261, -6.79682, -4.79372, -6.00881, -5.68528 }, // P_U_P_C
{ -6.62274, -3.59535, -3.06713, -3.11267, -2.91105, -3.54979, -2.98157, -2.80638, -3.07061, -3.54925, -4.44059, -3.22446, -2.96115, -4.13941, -3.55329,  -3.1098, -3.46462, -3.98279, -3.81159, -4.58667 }, // P_U_P_G
{ -6.62274, -5.86576, -5.51567, -5.78558, -5.25938, -5.85736,  -5.3826, -5.63381, -4.72941, -6.30079, -4.46591, -5.05704, -5.91215, -6.89095, -6.54185, -6.20085, -6.79682, -6.18002, -6.00881, -5.68528 }, // P_U_P_U
{ -6.62274, -9.26696, -7.18714, -6.07326,  -6.9123, -7.06133, -7.65128, -6.52111, -8.04964, -7.17625, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -4.99213 }, // P_U_P_N
{ -6.62274,  -9.9601, -8.10343, -7.61371, -7.16361, -7.75448, -7.65128, -8.87249,  -8.4551, -8.78569, -7.03086, -6.44334, -7.99159, -6.60327, -5.59739, -5.15939, -5.00506, -6.18002, -6.00881,  -4.1812 }, // P_N_P_A
{ -6.62274, -9.26696, -7.41029, -7.73149, -7.50009, -8.85309,  -7.3636, -8.46702, -9.14825, -8.09255, -8.12947, -6.73102, -7.29845, -5.59167, -5.02203, -4.94808, -5.18739, -6.18002, -6.00881, -3.89352 }, // P_N_P_C
{ -6.62274, -9.26696, -7.27052, -7.73149, -7.03008, -8.85309,  -7.3636, -8.87249, -9.14825, -8.78569, -8.12947, -6.44334, -7.99159, -5.91012, -5.12047, -4.59141, -5.18739, -6.18002, -4.62252, -4.99213 }, // P_N_P_G
{ -6.62274, -9.26696, -7.69797, -8.42464, -8.41638, -8.85309,  -7.3636, -8.17934, -9.14825, -7.68708, -7.03086, -7.13648, -7.99159, -6.60327, -6.54185, -4.18594, -4.15777,  -5.0814, -6.00881, -3.60584 }, // P_N_P_U
{ -6.62274, -4.76715, -4.09792, -5.02344, -7.16361, -6.77365, -6.67045, -7.36841, -9.14825, -8.78569, -8.12947, -7.82963, -7.99159, -7.98956, -8.48776, -7.99261, -6.79682, -6.18002, -6.00881, -2.74084 } // P_N_P_N
};

inline double lookup(Rules r, unsigned l)
{
  assert(r <= P_N_P_N);

  if (l < 6)
    return (rule_prob[r][0]);
  if (l < 11)
    return (rule_prob[r][1]);
  if (l < 21)
    return (rule_prob[r][2]);
  if (l < 31)
    return (rule_prob[r][3]);
  if (l < 41)
    return (rule_prob[r][4]);
  if (l < 51)
    return (rule_prob[r][5]);
  if (l < 61)
    return (rule_prob[r][6]);
  if (l < 101)
    return (rule_prob[r][7]);
  if (l < 151)
    return (rule_prob[r][8]);
  if (l < 201)
    return (rule_prob[r][9]);
  if (l < 251)
    return (rule_prob[r][10]);
  if (l < 301)
    return (rule_prob[r][11]);
  if (l < 351)
    return (rule_prob[r][12]);
  if (l < 401)
    return (rule_prob[r][13]);
  if (l < 501)
    return (rule_prob[r][14]);
  if (l < 601)
    return (rule_prob[r][15]);
  if (l < 701)
    return (rule_prob[r][16]);
  if (l < 801)
    return (rule_prob[r][17]);
  if (l < 1001)
    return (rule_prob[r][18]);
  return (rule_prob[r][19]);
}

#define MY_RATIONAL double
#include "look_helper.hh"

#endif